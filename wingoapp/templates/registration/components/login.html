{% load static %}
{% load sass_tags %}
<section>
  <div class="container-fluid p-0">
    <div class="row">
      <div class="col-12 form-login">
        <div class="login-card"><img class="img-fluid bg-img-cover"
            src="{% static 'assets/images/login/login_bg.jpg' %}" alt="">
          <form class="theme-form login-form" method="post">
            <div class="login-header text-center">
              <h4>Login</h4>
              <h6>PT SEIWA Indonesia.</h6>
              <p class="text-muted small">Sistem Informasi Terpadu SDBM</p>
            </div>
            
            {% csrf_token %}
            
            <!-- Tampilkan pesan error/sukses -->
            {% if messages %}
              {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                  {{ message }}
                  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
              {% endfor %}
            {% endif %}

            <!-- Form errors -->
            {% if form.non_field_errors %}
              <div class="alert alert-danger">
                {% for error in form.non_field_errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% endif %}

            <!-- Employee Number Field -->
            <div class="form-group">
              <label for="{{ form.employee_number.id_for_label }}">{{ form.employee_number.label }}</label>
              <div class="input-group">
                <span class="input-group-text"><i class="icon-user"></i></span>
                {{ form.employee_number }}
              </div>
              {% if form.employee_number.errors %}
                <div class="text-danger small mt-1">
                  {% for error in form.employee_number.errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}
            </div>

            <!-- Password Field -->
            <div class="form-group">
              <label for="{{ form.password.id_for_label }}">{{ form.password.label }}</label>
              <div class="input-group">
                <span class="input-group-text"><i class="icon-lock"></i></span>
                {{ form.password }}
                <div class="show-hide"><span class="show"></span></div>
              </div>
              {% if form.password.errors %}
                <div class="text-danger small mt-1">
                  {% for error in form.password.errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}
            </div>

            <!-- Remember Me Option (optional) -->
            <div class="form-group">
              <div class="checkbox">
                <input id="remember_me" name="remember_me" type="checkbox" value="1">
                <label for="remember_me">Ingat saya</label>
              </div>
              {% comment %}<a class="link" href="#" onclick="showForgotPassword()">Lupa password?</a>{% endcomment %}
            </div>

            <!-- Submit Button -->
            <div class="form-group">
              <button class="btn btn-primary btn-block" type="submit">
                <i class="icon-login me-2"></i>Masuk
              </button>
            </div>

            <!-- Additional Info -->
            <div class="text-center mt-3">
              <small class="text-muted">
                Gunakan nomor karyawan dan password SDBM Anda
              </small>
            </div>

            <!-- Footer Info -->
            <div class="text-center mt-4">
              <small class="text-muted">
                Â© {{ "now"|date:"Y" }} PT Seiwa Indonesia. All rights reserved.
              </small>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Custom Styles for SDBM Login -->
<style>
.login-card form .form-group label {
    font-weight: 600;
    color: #495057;
    margin-bottom: 5px;
}

.login-card form .input-group-text {
    background-color: transparent;
    border-right: none;
    color: #6c757d;
}

.login-card form .form-control {
    border-left: none;
    padding-left: 0;
}

.login-card form .form-control:focus {
    box-shadow: none;
    border-color: #007bff;
}

.login-card form .input-group:focus-within .input-group-text {
    border-color: #007bff;
    color: #007bff;
}

.alert {
    margin-bottom: 20px;
    border-radius: 8px;
    padding: 12px 15px;
}

.alert-danger {
    background-color: #f8d7da;
    border-color: #f5c6cb;
    color: #721c24;
}

.alert-success {
    background-color: #d4edda;
    border-color: #c3e6cb;
    color: #155724;
}

.alert-info {
    background-color: #cce7ff;
    border-color: #b6d7ff;
    color: #004085;
}

.text-danger.small {
    font-size: 0.8rem;
}

.login-header p {
    margin-bottom: 20px;
    font-size: 0.9rem;
}

.btn-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: none;
    padding: 12px 20px;
    font-weight: 600;
    border-radius: 8px;
    transition: all 0.3s ease;
}

.btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.checkbox input[type="checkbox"]:checked + label::before {
    background-color: #007bff;
    border-color: #007bff;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .login-card {
        margin: 10px;
    }
    
    .login-header h4 {
        font-size: 1.5rem;
    }
    
    .login-header h6 {
        font-size: 1rem;
    }
}
</style>

<!-- JavaScript for show/hide password and form validation -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Show/Hide Password Toggle
    const showHideElements = document.querySelectorAll('.show-hide');
    showHideElements.forEach(function(element) {
        element.addEventListener('click', function() {
            const passwordInput = this.previousElementSibling;
            const showSpan = this.querySelector('.show');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                showSpan.classList.add('hide');
            } else {
                passwordInput.type = 'password';
                showSpan.classList.remove('hide');
            }
        });
    });

    // Form validation
    const form = document.querySelector('.login-form');
    form.addEventListener('submit', function(e) {
        const employeeNumber = form.querySelector('input[name="employee_number"]').value;
        const password = form.querySelector('input[name="password"]').value;
        
        if (!employeeNumber.trim()) {
            e.preventDefault();
            alert('Nomor karyawan harus diisi!');
            return false;
        }
        
        if (!password.trim()) {
            e.preventDefault();
            alert('Password harus diisi!');
            return false;
        }
        
        // Show loading state
        const submitBtn = form.querySelector('button[type="submit"]');
        submitBtn.innerHTML = '<i class="fa fa-spinner fa-spin me-2"></i>Memverifikasi...';
        submitBtn.disabled = true;
    });

    // Auto dismiss alerts after 5 seconds
    const alerts = document.querySelectorAll('.alert:not(.alert-permanent)');
    alerts.forEach(function(alert) {
        setTimeout(function() {
            if (alert.querySelector('.btn-close')) {
                alert.querySelector('.btn-close').click();
            }
        }, 5000);
    });
});

// Function untuk forgot password (jika diperlukan di masa depan)
function showForgotPassword() {
    alert('Untuk reset password, silakan hubungi administrator IT atau HRD.');
}
</script>